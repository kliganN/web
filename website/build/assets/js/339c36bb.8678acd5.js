"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5857],{5830:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var i=s(5893),t=s(1151);const r={sidebar_position:14},a="Ansible. \u0423\u0441\u043b\u043e\u0432\u0438\u044f",l={id:"Ansible/ansible-conditions",title:"Ansible. \u0423\u0441\u043b\u043e\u0432\u0438\u044f",description:"\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0447\u0442\u043e \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0435 \u041f\u041e \u0443\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445, \u0438 \u0442\u0435\u043f\u0435\u0440\u044c \u0435\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c \u0444\u0430\u0439\u043b\u0435 \u0438 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u043b\u0435\u0439\u0431\u0443\u043a \u0441 \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c\u0438.",source:"@site/docs/Ansible/ansible-conditions.md",sourceDirName:"Ansible",slug:"/Ansible/ansible-conditions",permalink:"/docs/Ansible/ansible-conditions",draft:!1,unlisted:!1,editUrl:"https://github.com/kliganN/docusaurus-web/tree/main/docs/Ansible/ansible-conditions.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"tutorialSidebar",previous:{title:"Ansible. Variable",permalink:"/docs/Ansible/ansible-variable-eng"},next:{title:"Ansible. \u0423\u0441\u043b\u043e\u0432\u0438\u044f. \u041f\u0440\u0438\u043c\u0435\u0440\u044b",permalink:"/docs/Ansible/ansible-conditions-examples"}},o={},d=[{value:"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c \u0444\u0430\u0439\u043b\u0435",id:"\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0433\u0440\u0443\u043f\u043f\u0443-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432-\u0432-\u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c-\u0444\u0430\u0439\u043b\u0435",level:2},{value:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445",id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0437\u0430\u043f\u0443\u0441\u043a\u0430-\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432-\u043d\u0430-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445",level:3},{value:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 Nginx \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430\u0445 Linux",id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-nginx-\u043d\u0430-\u0440\u0430\u0437\u043d\u044b\u0445-\u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430\u0445-linux",level:3},{value:"\u0412 \u0442\u0440\u0435\u0442\u044c\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0446\u0438\u043a\u043b \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u044b.",id:"\u0432-\u0442\u0440\u0435\u0442\u044c\u0435\u043c-\u043f\u0440\u0438\u043c\u0435\u0440\u0435-\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f-\u0446\u0438\u043a\u043b-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-\u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445-\u043f\u0430\u043a\u0435\u0442\u043e\u0432-\u043d\u0430-\u0441\u0435\u0440\u0432\u0435\u0440\u044b",level:2},{value:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432",id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-\u043f\u0430\u043a\u0435\u0442\u043e\u0432",level:3},{value:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043f\u043e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435",id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438-\u0441\u0442\u0430\u0442\u0443\u0441\u0430-\u0441\u0435\u0440\u0432\u0438\u0441\u0430-\u0438-\u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438-\u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f-\u043f\u043e-\u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439-\u043f\u043e\u0447\u0442\u0435",level:3}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"ansible-\u0443\u0441\u043b\u043e\u0432\u0438\u044f",children:"Ansible. \u0423\u0441\u043b\u043e\u0432\u0438\u044f"}),"\n",(0,i.jsx)(e.p,{children:"\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0447\u0442\u043e \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0435 \u041f\u041e \u0443\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445, \u0438 \u0442\u0435\u043f\u0435\u0440\u044c \u0435\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c \u0444\u0430\u0439\u043b\u0435 \u0438 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u043b\u0435\u0439\u0431\u0443\u043a \u0441 \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c\u0438."}),"\n",(0,i.jsx)(e.p,{children:"\u0412 \u043f\u0435\u0440\u0432\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u043f\u043b\u0435\u0439\u0431\u0443\u043a \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441\u044b mysqld \u0438 httpd \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0438\u0445 \u0438\u043c\u0435\u043d\u0438 \u0445\u043e\u0441\u0442\u0430."}),"\n",(0,i.jsx)(e.h2,{id:"\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0433\u0440\u0443\u043f\u043f\u0443-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432-\u0432-\u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c-\u0444\u0430\u0439\u043b\u0435",children:"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u043e\u043c \u0444\u0430\u0439\u043b\u0435"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:'title="hosts"',children:"[all_servers]\r\ndb.domain.com\r\nweb1.domain.com\r\nweb2.domain.com\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0437\u0430\u043f\u0443\u0441\u043a\u0430-\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432-\u043d\u0430-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445",children:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",metastring:'title="start.yml"',children:'- name: Start services\r\n  hosts: all_servers\r\n  tasks:\r\n    - service:\r\n        name: mysqld\r\n        state: started\r\n      when: ansible_host == "db.domain.com"\r\n    - service:\r\n        name: httpd\r\n        state: started\r\n      when: ansible_host == "web1.domain.com" or ansible_host == "web2.domain.com"\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u0412\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u043f\u043b\u0435\u0439\u0431\u0443\u043a \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 Nginx \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430\u0445 Linux \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0443\u0441\u043b\u043e\u0432\u0438\u044f ",(0,i.jsx)(e.code,{children:"ansible_os_family"}),", \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0441\u0435\u043c\u0435\u0439\u0441\u0442\u0432\u043e \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b."]}),"\n",(0,i.jsx)(e.h3,{id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-nginx-\u043d\u0430-\u0440\u0430\u0437\u043d\u044b\u0445-\u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430\u0445-linux",children:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 Nginx \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430\u0445 Linux"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",metastring:'title="nginx-inst.yml"',children:'- name: Install nginx\r\n  hosts: all\r\n  tasks:\r\n    - name: install nginx on ubuntu\r\n      apt:\r\n        name: nginx\r\n        state: present\r\n      when: ansible_os_family == "Debian" and ansible_distribution_version == "16.04"\r\n    - name: install nginx on centos\r\n      yum:\r\n        name: nginx\r\n        state: present\r\n      when: ansible_os_family == "RedHat" or ansible_os_family == "Suse"\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u0432-\u0442\u0440\u0435\u0442\u044c\u0435\u043c-\u043f\u0440\u0438\u043c\u0435\u0440\u0435-\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f-\u0446\u0438\u043a\u043b-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-\u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445-\u043f\u0430\u043a\u0435\u0442\u043e\u0432-\u043d\u0430-\u0441\u0435\u0440\u0432\u0435\u0440\u044b",children:"\u0412 \u0442\u0440\u0435\u0442\u044c\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0446\u0438\u043a\u043b \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u044b."}),"\n",(0,i.jsx)(e.h3,{id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438-\u043f\u0430\u043a\u0435\u0442\u043e\u0432",children:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",metastring:'title="aptinstall.yml"',children:'- name: install web\r\n  hosts: all\r\n  vars:\r\n    packages:\r\n    - name: nginx\r\n      required: True\r\n    - name: mysql\r\n      required: True\r\n    - name: httpd\r\n      required: False\r\n  tasks:\r\n    - name: Install "{{ item.name }}" on Ubuntu\r\n      apt:\r\n        name: "{{ item.name }}"\r\n        state: present\r\n      when: item.required == True\r\n      loop: "{{ packages }}"\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u0412 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u044f ",(0,i.jsx)(e.code,{children:"when"})," \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043f\u043e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435, \u0435\u0441\u043b\u0438 \u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442."]}),"\n",(0,i.jsx)(e.h3,{id:"\u043f\u043b\u0435\u0439\u0431\u0443\u043a-\u0434\u043b\u044f-\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438-\u0441\u0442\u0430\u0442\u0443\u0441\u0430-\u0441\u0435\u0440\u0432\u0438\u0441\u0430-\u0438-\u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438-\u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f-\u043f\u043e-\u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439-\u043f\u043e\u0447\u0442\u0435",children:"\u041f\u043b\u0435\u0439\u0431\u0443\u043a \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043f\u043e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",metastring:'title="checkstatus.yml"',children:"- name: Check status of and email if its down\r\n  hosts: localhost\r\n  tasks:\r\n    - command: service httpd status\r\n      register: command_output\r\n    - mail:\r\n        to: Admins <sysadmin@domain.com>\r\n        subject: Service alert\r\n        body: \"Httpd on {{ ansible_hostname }} is down\"\r\n      when: command_output.stdout.find('down') != -1\n"})})]})}function m(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},1151:(n,e,s)=>{s.d(e,{Z:()=>l,a:()=>a});var i=s(7294);const t={},r=i.createContext(t);function a(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);